---
import BaseHead from '../../components/BaseHead.astro'
import Header from '../../components/Header.astro'
import { getCollection } from 'astro:content'
import FormattedDate from '../../components/FormattedDate.astro'
import { Image } from 'astro:assets'

const recipes = (await getCollection('recipes')).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title="Recipes" />
  </head>

  <body class="min-h-screen bg-gray-900 font-sans text-gray-100">
    <Header title="Recipes" />

    <main class="mx-auto max-w-6xl px-4 py-10">
      <ul class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
        {
          recipes.map((recipe) => (
            <li>
              <a
                href={`/recipes/${recipe.id}/`}
                class="group block focus:outline-none focus-visible:ring-2 focus-visible:ring-gray-400/40"
              >
                <div
                  class="
                    aspect-[2/1] overflow-hidden rounded-xl bg-gray-800/40
                    ring-1 ring-gray-800/60
                    transition duration-200
                    group-hover:ring-4 group-hover:ring-gray-500/40
                    group-hover:shadow-lg
                  "
                >
                  {recipe.data.heroImage && (
                    <Image
                      class="h-full w-full object-cover object-center"
                      src={recipe.data.heroImage}
                      alt={recipe.data.title}
                      widths={[360, 720]}
                      sizes="(max-width: 720px) 100vw, 360px"
                      loading="lazy"
                      decoding="async"
                    />
                  )}
                </div>

                <h2 class="mt-3 text-2xl font-semibold leading-tight text-gray-100">{recipe.data.title}</h2>

                <p class="mt-1 text-sm text-gray-400">
                  <FormattedDate date={recipe.data.pubDate} />
                </p>
              </a>
            </li>
          ))
        }
      </ul>
    </main>
  </body>
</html>
